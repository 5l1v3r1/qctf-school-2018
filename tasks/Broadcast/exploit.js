ws = new WebSocket("ws://localhost:8080/broadcast");
ws.binaryType = 'blob';
var buffer;

function send_code() {
    setTimeout(1000);
    var enc = new TextEncoder();
    ws.send(enc.encode("alohomora"))
}

ws.onmessage = function (event) {
    if (typeof event.data === "string") {
        console.log(event.data);
    } else {
        var reader = new FileReader();
        reader.readAsArrayBuffer(event.data);
        reader.addEventListener("loadend", function (e) {
            buffer = new Uint16Array(e.target.result);
            var dec = new TextDecoder("utf-8");
            dec.decode(buffer);
            console.log(dec.decode(buffer));
            send_code()
        });
    }
};